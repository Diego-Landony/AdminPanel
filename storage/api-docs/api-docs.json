{
    "openapi": "3.0.0",
    "info": {
        "title": "Subway Guatemala Customer API",
        "description": "API REST para la aplicación móvil de clientes de Subway Guatemala. Incluye autenticación multi-canal (email/password, Google OAuth, Apple Sign-In), gestión de perfil, dispositivos FCM y futuras funcionalidades de pedidos y lealtad.",
        "contact": {
            "email": "dev@subwayguatemala.com"
        },
        "version": "1.0.0"
    },
    "servers": [
        {
            "url": "http://localhost:8000",
            "description": "Local Development Server"
        },
        {
            "url": "https://admin.subwaycardgt.com/",
            "description": "Application Server"
        }
    ],
    "paths": {
        "/api/v1/auth/register": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Register a new customer",
                "description": "Creates a new customer account with email and password. Sends email verification notification.",
                "operationId": "7ca6fc7989202054d29707fef91a2d4a",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "name",
                                    "email",
                                    "password",
                                    "password_confirmation"
                                ],
                                "properties": {
                                    "name": {
                                        "description": "Customer full name",
                                        "type": "string",
                                        "example": "Juan Pérez"
                                    },
                                    "email": {
                                        "description": "Valid email address",
                                        "type": "string",
                                        "format": "email",
                                        "example": "juan@example.com"
                                    },
                                    "password": {
                                        "description": "Min 6 characters, 1 letter, 1 number",
                                        "type": "string",
                                        "format": "password",
                                        "example": "Pass123"
                                    },
                                    "password_confirmation": {
                                        "description": "Must match password",
                                        "type": "string",
                                        "format": "password",
                                        "example": "Pass123"
                                    },
                                    "phone": {
                                        "description": "Optional phone number",
                                        "type": "string",
                                        "example": "+50212345678",
                                        "nullable": true
                                    },
                                    "birth_date": {
                                        "description": "Optional birth date",
                                        "type": "string",
                                        "format": "date",
                                        "example": "1990-05-15",
                                        "nullable": true
                                    },
                                    "gender": {
                                        "description": "Optional gender",
                                        "type": "string",
                                        "enum": [
                                            "male",
                                            "female",
                                            "other"
                                        ],
                                        "example": "male",
                                        "nullable": true
                                    },
                                    "os": {
                                        "description": "Operating system",
                                        "type": "string",
                                        "enum": [
                                            "ios",
                                            "android",
                                            "web"
                                        ],
                                        "example": "ios",
                                        "nullable": true
                                    },
                                    "device_identifier": {
                                        "description": "RECOMMENDED: Unique device UUID for tracking",
                                        "type": "string",
                                        "example": "550e8400-e29b-41d4-a716-446655440000",
                                        "nullable": true
                                    },
                                    "device_fingerprint": {
                                        "description": "Optional: SHA256 hash of device characteristics",
                                        "type": "string",
                                        "example": "a1b2c3d4e5f6...",
                                        "nullable": true
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Registration successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Registro exitoso. Por favor verifica tu email."
                                        },
                                        "data": {
                                            "properties": {
                                                "customer": {
                                                    "$ref": "#/components/schemas/Customer"
                                                },
                                                "token": {
                                                    "type": "string",
                                                    "example": "1|abc123xyz..."
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "The email has already been taken."
                                        },
                                        "errors": {
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Too many requests"
                    }
                }
            }
        },
        "/api/v1/auth/login": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Login with email and password",
                "description": "Authenticates customer and returns Sanctum token. Rate limited to 5 attempts per minute.",
                "operationId": "9d0bb5c770cbec19b0b9566606ef4adb",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "email",
                                    "password"
                                ],
                                "properties": {
                                    "email": {
                                        "type": "string",
                                        "format": "email",
                                        "example": "juan@example.com"
                                    },
                                    "password": {
                                        "type": "string",
                                        "format": "password",
                                        "example": "SecurePass123!"
                                    },
                                    "os": {
                                        "description": "Operating system",
                                        "type": "string",
                                        "enum": [
                                            "ios",
                                            "android",
                                            "web"
                                        ],
                                        "example": "ios",
                                        "nullable": true
                                    },
                                    "device_identifier": {
                                        "description": "RECOMMENDED: Unique device UUID for tracking",
                                        "type": "string",
                                        "example": "550e8400-e29b-41d4-a716-446655440000",
                                        "nullable": true
                                    },
                                    "device_fingerprint": {
                                        "description": "Optional: SHA256 hash of device characteristics",
                                        "type": "string",
                                        "example": "a1b2c3d4e5f6...",
                                        "nullable": true
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Login successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Inicio de sesión exitoso."
                                        },
                                        "data": {
                                            "properties": {
                                                "customer": {
                                                    "$ref": "#/components/schemas/Customer"
                                                },
                                                "token": {
                                                    "type": "string",
                                                    "example": "1|abc123xyz..."
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Invalid credentials or OAuth account"
                    },
                    "429": {
                        "description": "Too many login attempts"
                    }
                }
            }
        },
        "/api/v1/auth/logout": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Logout from current device",
                "description": "Revokes the current access token. Other devices remain logged in.",
                "operationId": "3a27a9e02ceb521eb3f98c8d2394aef9",
                "responses": {
                    "200": {
                        "description": "Logout successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Sesión cerrada exitosamente."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthenticated"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/api/v1/auth/logout-all": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Logout from all devices",
                "description": "Revokes all access tokens. Customer will be logged out from all devices.",
                "operationId": "afe5fcc3199730bf8caf978b67c6a0c0",
                "responses": {
                    "200": {
                        "description": "Logout successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Se cerraron todas las sesiones exitosamente."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthenticated"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/api/v1/auth/refresh": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Refresh access token",
                "description": "Generates new access token and revokes the old one. Token rotation for security.",
                "operationId": "437b695fba1c5eecef1841f958322adc",
                "responses": {
                    "200": {
                        "description": "Token refreshed successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Token renovado exitosamente."
                                        },
                                        "data": {
                                            "properties": {
                                                "token": {
                                                    "type": "string",
                                                    "example": "2|xyz456abc..."
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthenticated"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/api/v1/auth/forgot-password": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Request password reset",
                "description": "Sends password reset link to customer's email. Only for local accounts (not OAuth).",
                "operationId": "4011ca27431b5cd53a225688e531de47",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "email"
                                ],
                                "properties": {
                                    "email": {
                                        "type": "string",
                                        "format": "email",
                                        "example": "juan@example.com"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Reset link sent",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Enlace de restablecimiento de contraseña enviado."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation error"
                    },
                    "429": {
                        "description": "Too many requests"
                    }
                }
            }
        },
        "/api/v1/auth/reset-password": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Reset password",
                "description": "Resets password using token from email. Revokes all existing tokens for security.",
                "operationId": "aba7a33c4064b5b1a2f3a8a70c20094b",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "email",
                                    "password",
                                    "password_confirmation",
                                    "token"
                                ],
                                "properties": {
                                    "email": {
                                        "type": "string",
                                        "format": "email",
                                        "example": "juan@example.com"
                                    },
                                    "password": {
                                        "type": "string",
                                        "format": "password",
                                        "example": "NewSecurePass123!"
                                    },
                                    "password_confirmation": {
                                        "type": "string",
                                        "format": "password",
                                        "example": "NewSecurePass123!"
                                    },
                                    "token": {
                                        "type": "string",
                                        "example": "abc123resettoken456"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Password reset successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Contraseña restablecida exitosamente."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Invalid token or validation error"
                    },
                    "429": {
                        "description": "Too many requests"
                    }
                }
            }
        },
        "/api/v1/auth/email/verify/{id}/{hash}": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Verify email address",
                "description": "Verifies customer email using signed URL from verification email.",
                "operationId": "1cd7d201c16988ffdc55af25262f9ac8",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Customer ID",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    },
                    {
                        "name": "hash",
                        "in": "path",
                        "description": "Email hash for verification",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Email verified successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Email verificado exitosamente."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Invalid verification link"
                    },
                    "429": {
                        "description": "Too many requests"
                    }
                }
            }
        },
        "/api/v1/auth/email/resend": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Resend verification email",
                "description": "Sends a new verification email to the customer.",
                "operationId": "f07474133b03f2e2f82012253317a15f",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "email"
                                ],
                                "properties": {
                                    "email": {
                                        "type": "string",
                                        "format": "email",
                                        "example": "juan@example.com"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Verification email sent",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Enlace de verificación reenviado."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Email not found or already verified"
                    },
                    "429": {
                        "description": "Too many requests"
                    }
                }
            }
        },
        "/api/v1/auth/oauth/google": {
            "post": {
                "tags": [
                    "OAuth"
                ],
                "summary": "Login with Google (Mobile)",
                "description": "Authenticates customer using Google OAuth id_token from mobile app. If email exists, links Google account. If email doesn't exist, returns error asking to register first. Does NOT auto-create accounts.",
                "operationId": "7de0059c713c7fba77ef30a111c1522e",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "id_token"
                                ],
                                "properties": {
                                    "id_token": {
                                        "description": "Google OAuth id_token obtained from Google Sign-In SDK",
                                        "type": "string",
                                        "example": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjhlY..."
                                    },
                                    "os": {
                                        "description": "Operating system",
                                        "type": "string",
                                        "enum": [
                                            "ios",
                                            "android",
                                            "web"
                                        ],
                                        "example": "android",
                                        "nullable": true
                                    },
                                    "device_identifier": {
                                        "description": "RECOMMENDED: Unique device UUID for tracking",
                                        "type": "string",
                                        "example": "550e8400-e29b-41d4-a716-446655440000",
                                        "nullable": true
                                    },
                                    "device_fingerprint": {
                                        "description": "Optional: SHA256 hash of device characteristics",
                                        "type": "string",
                                        "example": "a1b2c3d4e5f6...",
                                        "nullable": true
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Authentication successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Inicio de sesión exitoso."
                                        },
                                        "data": {
                                            "properties": {
                                                "customer": {
                                                    "$ref": "#/components/schemas/Customer"
                                                },
                                                "token": {
                                                    "type": "string",
                                                    "example": "1|abc123xyz..."
                                                },
                                                "is_new_customer": {
                                                    "description": "True if account was just created",
                                                    "type": "boolean",
                                                    "example": false
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Invalid token or account conflict",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Token de Google inválido o expirado."
                                        },
                                        "errors": {
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Too many requests"
                    }
                }
            }
        },
        "/api/v1/auth/oauth/google/register": {
            "post": {
                "tags": [
                    "OAuth"
                ],
                "summary": "Register with Google (Mobile)",
                "description": "Registers new customer using Google OAuth id_token from mobile app. Creates new account if email doesn't exist. If email already exists, returns error.",
                "operationId": "66361e213aae994ffa0e9b6967818e9d",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "id_token"
                                ],
                                "properties": {
                                    "id_token": {
                                        "description": "Google OAuth id_token obtained from Google Sign-In SDK",
                                        "type": "string",
                                        "example": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjhlY..."
                                    },
                                    "os": {
                                        "description": "Operating system",
                                        "type": "string",
                                        "enum": [
                                            "ios",
                                            "android",
                                            "web"
                                        ],
                                        "example": "android",
                                        "nullable": true
                                    },
                                    "device_identifier": {
                                        "description": "RECOMMENDED: Unique device UUID for tracking",
                                        "type": "string",
                                        "example": "550e8400-e29b-41d4-a716-446655440000",
                                        "nullable": true
                                    },
                                    "device_fingerprint": {
                                        "description": "Optional: SHA256 hash of device characteristics",
                                        "type": "string",
                                        "example": "a1b2c3d4e5f6...",
                                        "nullable": true
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Registration successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Cuenta creada exitosamente."
                                        },
                                        "data": {
                                            "properties": {
                                                "customer": {
                                                    "$ref": "#/components/schemas/Customer"
                                                },
                                                "token": {
                                                    "type": "string",
                                                    "example": "1|abc123xyz..."
                                                },
                                                "is_new_customer": {
                                                    "type": "boolean",
                                                    "example": true
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Email already exists or invalid token",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Ya existe una cuenta con este correo electrónico."
                                        },
                                        "errors": {
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Too many requests"
                    }
                }
            }
        },
        "/api/v1/auth/oauth/google/mobile": {
            "get": {
                "tags": [
                    "OAuth"
                ],
                "summary": "Redirect to Google OAuth (Mobile)",
                "description": "Redirects user to Google OAuth consent screen for mobile apps. Stores session data to redirect back to mobile app after authentication.",
                "operationId": "f092d1e5c1a89c8dc0d29868f9a8fffa",
                "parameters": [
                    {
                        "name": "action",
                        "in": "query",
                        "description": "Action type: login or register",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "enum": [
                                "login",
                                "register"
                            ]
                        }
                    },
                    {
                        "name": "device_id",
                        "in": "query",
                        "description": "Device identifier",
                        "required": false,
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "name": "os",
                        "in": "query",
                        "description": "Operating system",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "enum": [
                                "ios",
                                "android"
                            ]
                        }
                    }
                ],
                "responses": {
                    "302": {
                        "description": "Redirect to Google"
                    }
                }
            }
        },
        "/api/v1/auth/oauth/google/redirect": {
            "get": {
                "tags": [
                    "OAuth"
                ],
                "summary": "Redirect to Google OAuth (Web)",
                "description": "Redirects user to Google OAuth consent screen. For web applications only. Mobile apps should use POST /api/v1/auth/oauth/google with id_token.",
                "operationId": "d45644767bd0769d1084909175bff619",
                "responses": {
                    "302": {
                        "description": "Redirect to Google"
                    }
                }
            }
        },
        "/api/v1/auth/oauth/google/callback": {
            "get": {
                "tags": [
                    "OAuth"
                ],
                "summary": "Handle Google OAuth callback (Web & Mobile)",
                "description": "Handles Google OAuth callback and returns authentication token. For web applications, returns JSON. For mobile, redirects to app via deep link. If email doesn't exist (login action), returns error asking user to register first.",
                "operationId": "281ab9caddb2b86e3614c9e34567db4f",
                "parameters": [
                    {
                        "name": "code",
                        "in": "query",
                        "description": "Authorization code from Google",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "name": "state",
                        "in": "query",
                        "description": "CSRF state token",
                        "required": false,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Authentication successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Inicio de sesión exitoso."
                                        },
                                        "data": {
                                            "properties": {
                                                "customer": {
                                                    "$ref": "#/components/schemas/Customer"
                                                },
                                                "token": {
                                                    "type": "string",
                                                    "example": "1|abc123xyz..."
                                                },
                                                "is_new_customer": {
                                                    "type": "boolean",
                                                    "example": false
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "302": {
                        "description": "Redirect to mobile app with token"
                    },
                    "422": {
                        "description": "Email not registered or other validation error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "No existe una cuenta con este correo electrónico. Por favor regístrate primero."
                                        },
                                        "errors": {
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/v1/devices": {
            "get": {
                "tags": [
                    "Devices"
                ],
                "summary": "List customer devices",
                "description": "Returns all active devices for authenticated customer. Current device is flagged with is_current_device=true.",
                "operationId": "afcbc146bf93b130969374c0c29f42f6",
                "responses": {
                    "200": {
                        "description": "Devices retrieved successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "data": {
                                            "type": "array",
                                            "items": {
                                                "$ref": "#/components/schemas/CustomerDevice"
                                            }
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthenticated"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/api/v1/devices/register": {
            "post": {
                "tags": [
                    "Devices"
                ],
                "summary": "Register or update device",
                "description": "Enriches existing device (auto-created during auth) with FCM token and additional metadata. If device doesn't exist, creates it.",
                "operationId": "0743195c75a8fccfdf9875291bd6d8c0",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "fcm_token",
                                    "device_type"
                                ],
                                "properties": {
                                    "fcm_token": {
                                        "description": "Firebase Cloud Messaging token",
                                        "type": "string",
                                        "example": "fKw8h4Xj..."
                                    },
                                    "device_identifier": {
                                        "description": "Unique device identifier (should match identifier from auth)",
                                        "type": "string",
                                        "example": "ABC123DEF456",
                                        "nullable": true
                                    },
                                    "device_fingerprint": {
                                        "description": "SHA256 hash of device characteristics",
                                        "type": "string",
                                        "example": "sha256_hash...",
                                        "nullable": true
                                    },
                                    "device_type": {
                                        "description": "Device platform",
                                        "type": "string",
                                        "enum": [
                                            "ios",
                                            "android",
                                            "web"
                                        ],
                                        "example": "ios"
                                    },
                                    "device_name": {
                                        "description": "Human-readable device name",
                                        "type": "string",
                                        "example": "iPhone 14 Pro",
                                        "nullable": true
                                    },
                                    "device_model": {
                                        "description": "Device model identifier",
                                        "type": "string",
                                        "example": "iPhone15,2",
                                        "nullable": true
                                    },
                                    "app_version": {
                                        "description": "App version number",
                                        "type": "string",
                                        "example": "1.0.5",
                                        "nullable": true
                                    },
                                    "os_version": {
                                        "description": "OS version number",
                                        "type": "string",
                                        "example": "17.2",
                                        "nullable": true
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Device registered or updated successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Dispositivo registrado exitosamente."
                                        },
                                        "data": {
                                            "$ref": "#/components/schemas/CustomerDevice"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthenticated"
                    },
                    "422": {
                        "description": "Validation error"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/api/v1/devices/{device}": {
            "delete": {
                "tags": [
                    "Devices"
                ],
                "summary": "Deactivate device",
                "description": "Marks device as inactive (soft deactivate). Device will no longer receive push notifications.",
                "operationId": "a9545ae592649836835794a3421d3551",
                "parameters": [
                    {
                        "name": "device",
                        "in": "path",
                        "description": "Device ID",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Device deactivated successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Dispositivo desactivado exitosamente."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthenticated"
                    },
                    "403": {
                        "description": "Forbidden - device belongs to another customer"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/api/v1/profile": {
            "get": {
                "tags": [
                    "Profile"
                ],
                "summary": "Get customer profile",
                "description": "Returns authenticated customer profile with addresses, NITs, and active devices.",
                "operationId": "dffac35700b3186de8d19cc212fe0285",
                "responses": {
                    "200": {
                        "description": "Profile retrieved successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "data": {
                                            "properties": {
                                                "customer": {
                                                    "$ref": "#/components/schemas/Customer"
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthenticated"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            },
            "put": {
                "tags": [
                    "Profile"
                ],
                "summary": "Update customer profile",
                "description": "Updates customer profile information. If email is changed, marks email as unverified.",
                "operationId": "d682da2fd566e34f597e169ac582ad3f",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "name": {
                                        "type": "string",
                                        "example": "Juan Pérez Actualizado"
                                    },
                                    "email": {
                                        "type": "string",
                                        "format": "email",
                                        "example": "nuevo@example.com"
                                    },
                                    "phone": {
                                        "type": "string",
                                        "example": "+50212345678",
                                        "nullable": true
                                    },
                                    "birth_date": {
                                        "type": "string",
                                        "format": "date",
                                        "example": "1990-05-15",
                                        "nullable": true
                                    },
                                    "gender": {
                                        "type": "string",
                                        "enum": [
                                            "male",
                                            "female",
                                            "other"
                                        ],
                                        "example": "male",
                                        "nullable": true
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Profile updated successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Perfil actualizado exitosamente."
                                        },
                                        "data": {
                                            "properties": {
                                                "customer": {
                                                    "$ref": "#/components/schemas/Customer"
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthenticated"
                    },
                    "422": {
                        "description": "Validation error"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            },
            "delete": {
                "tags": [
                    "Profile"
                ],
                "summary": "Delete customer account",
                "description": "Soft deletes customer account. Requires password confirmation for local accounts. Revokes all tokens.",
                "operationId": "dd388e266427403d3d4573c1104c784a",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "password"
                                ],
                                "properties": {
                                    "password": {
                                        "description": "Current password for verification",
                                        "type": "string",
                                        "format": "password",
                                        "example": "SecurePass123!"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Account deleted successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Cuenta eliminada exitosamente."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthenticated"
                    },
                    "422": {
                        "description": "Incorrect password"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/api/v1/profile/avatar": {
            "post": {
                "tags": [
                    "Profile"
                ],
                "summary": "Update customer avatar",
                "description": "Updates customer avatar URL. Can be a URL to uploaded image or OAuth provider avatar.",
                "operationId": "b67e208bcaefaa8d266a90398752d0c6",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "avatar"
                                ],
                                "properties": {
                                    "avatar": {
                                        "description": "Avatar URL",
                                        "type": "string",
                                        "example": "https://example.com/avatar.jpg"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Avatar updated successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Avatar actualizado exitosamente."
                                        },
                                        "data": {
                                            "properties": {
                                                "avatar": {
                                                    "type": "string",
                                                    "example": "https://example.com/avatar.jpg"
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthenticated"
                    },
                    "422": {
                        "description": "Validation error"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            },
            "delete": {
                "tags": [
                    "Profile"
                ],
                "summary": "Delete customer avatar",
                "description": "Removes customer avatar. Sets avatar to null.",
                "operationId": "c62431c4a1d50a4ac550be7c4bf25477",
                "responses": {
                    "200": {
                        "description": "Avatar deleted successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Avatar eliminado exitosamente."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthenticated"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/api/v1/profile/password": {
            "put": {
                "tags": [
                    "Profile"
                ],
                "summary": "Update customer password",
                "description": "Changes customer password. Only for local accounts (not OAuth). Revokes all tokens except current one for security.",
                "operationId": "141e4afbe7b6c73bcd252f096680adb5",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "current_password",
                                    "password",
                                    "password_confirmation"
                                ],
                                "properties": {
                                    "current_password": {
                                        "description": "Current password for verification",
                                        "type": "string",
                                        "format": "password",
                                        "example": "OldPass123!"
                                    },
                                    "password": {
                                        "description": "New password",
                                        "type": "string",
                                        "format": "password",
                                        "example": "NewSecurePass123!"
                                    },
                                    "password_confirmation": {
                                        "description": "Must match new password",
                                        "type": "string",
                                        "format": "password",
                                        "example": "NewSecurePass123!"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Password updated successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Contraseña actualizada exitosamente. Se cerraron todas las otras sesiones."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthenticated"
                    },
                    "422": {
                        "description": "Validation error or OAuth account"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        }
    },
    "components": {
        "schemas": {
            "Customer": {
                "title": "Customer",
                "description": "Customer model with profile information",
                "properties": {
                    "id": {
                        "type": "integer",
                        "example": 1
                    },
                    "name": {
                        "type": "string",
                        "example": "Juan Pérez"
                    },
                    "email": {
                        "type": "string",
                        "format": "email",
                        "example": "juan@example.com"
                    },
                    "phone": {
                        "type": "string",
                        "example": "+50212345678",
                        "nullable": true
                    },
                    "birth_date": {
                        "type": "string",
                        "format": "date",
                        "example": "1990-05-15",
                        "nullable": true
                    },
                    "gender": {
                        "type": "string",
                        "enum": [
                            "male",
                            "female",
                            "other"
                        ],
                        "example": "male",
                        "nullable": true
                    },
                    "avatar": {
                        "type": "string",
                        "example": "https://example.com/avatar.jpg",
                        "nullable": true
                    },
                    "oauth_provider": {
                        "type": "string",
                        "enum": [
                            "local",
                            "google",
                            "apple"
                        ],
                        "example": "local"
                    },
                    "email_verified_at": {
                        "type": "string",
                        "format": "date-time",
                        "example": "2024-01-15T10:30:00Z",
                        "nullable": true
                    },
                    "last_login_at": {
                        "type": "string",
                        "format": "date-time",
                        "example": "2024-01-20T15:45:00Z",
                        "nullable": true
                    },
                    "customer_type_id": {
                        "type": "integer",
                        "example": 1,
                        "nullable": true
                    },
                    "created_at": {
                        "type": "string",
                        "format": "date-time",
                        "example": "2024-01-10T08:00:00Z"
                    },
                    "updated_at": {
                        "type": "string",
                        "format": "date-time",
                        "example": "2024-01-20T15:45:00Z"
                    }
                },
                "type": "object"
            },
            "CustomerDevice": {
                "title": "CustomerDevice",
                "description": "Customer device registered for push notifications",
                "properties": {
                    "id": {
                        "type": "integer",
                        "example": 1
                    },
                    "customer_id": {
                        "type": "integer",
                        "example": 1
                    },
                    "sanctum_token_id": {
                        "type": "integer",
                        "example": 5,
                        "nullable": true
                    },
                    "fcm_token": {
                        "type": "string",
                        "example": "fKw8h4Xj..."
                    },
                    "device_identifier": {
                        "type": "string",
                        "example": "ABC123DEF456"
                    },
                    "device_type": {
                        "type": "string",
                        "enum": [
                            "ios",
                            "android",
                            "web"
                        ],
                        "example": "ios"
                    },
                    "device_name": {
                        "type": "string",
                        "example": "iPhone 14 Pro",
                        "nullable": true
                    },
                    "device_model": {
                        "type": "string",
                        "example": "iPhone15,2",
                        "nullable": true
                    },
                    "app_version": {
                        "type": "string",
                        "example": "1.0.5",
                        "nullable": true
                    },
                    "os_version": {
                        "type": "string",
                        "example": "17.2",
                        "nullable": true
                    },
                    "last_used_at": {
                        "type": "string",
                        "format": "date-time",
                        "example": "2024-01-20T15:45:00Z",
                        "nullable": true
                    },
                    "is_active": {
                        "type": "boolean",
                        "example": true
                    },
                    "is_current_device": {
                        "description": "True if this device is associated with current token",
                        "type": "boolean",
                        "example": true
                    },
                    "created_at": {
                        "type": "string",
                        "format": "date-time",
                        "example": "2024-01-10T08:00:00Z"
                    },
                    "updated_at": {
                        "type": "string",
                        "format": "date-time",
                        "example": "2024-01-20T15:45:00Z"
                    }
                },
                "type": "object"
            }
        },
        "securitySchemes": {
            "sanctum": {
                "type": "http",
                "description": "Laravel Sanctum Bearer Token. Obtain from /api/v1/auth/login, /api/v1/auth/register, or OAuth endpoints.",
                "bearerFormat": "JWT",
                "scheme": "bearer"
            }
        }
    },
    "tags": [
        {
            "name": "Authentication",
            "description": "Endpoints para registro, inicio de sesión, recuperación de contraseña y verificación de email"
        },
        {
            "name": "OAuth",
            "description": "Endpoints para autenticación con Google y Apple Sign-In"
        },
        {
            "name": "Profile",
            "description": "Gestión del perfil del cliente"
        },
        {
            "name": "Devices",
            "description": "Gestión de dispositivos y tokens FCM para notificaciones push"
        }
    ]
}